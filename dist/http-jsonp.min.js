/*!
 * http-jsonp v1.0.0
 * 
 * Copyright (c) 2019-present Derek Li
 * Released under the MIT License - https://choosealicense.com/licenses/mit/
 * 
 * https://github.com/iDerekLi/http-jsonp
 */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).httpJsonp=r()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function r(e){function n(n,t){if("object"==typeof e[t]&&"object"==typeof n)e[t]=r(e[t],n);else if("object"==typeof n&&null!==n){var o="[object Array]"===Object.prototype.toString.call(n)?[]:{};e[t]=r(o,n)}else e[t]=n}for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];for(var c=0,l=o.length;c<l;c++)for(var i in o[c])n(o[c][i],i);return e}function n(e,r){for(var n in r)if(e===r[n])return!0;return!1}function t(e,r){void 0===r&&(r=""),r="boolean"==typeof r?"?":r;var t=[],o=function(r){var o=e[r];if(n(o,["",undefined,null]))return"continue";o.constructor===Array?o.forEach(function(e){t.push(encodeURIComponent(r)+"[]="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o))};for(var a in e)o(a);return t.length?r+t.join("&"):""}var o={baseURL:"",url:"",params:{},callbackProp:"callback",prefix:"__httpJsonp",name:"Callback",timeout:6e4,scriptAttr:{type:"",charset:"",crossOrigin:null,async:!0,defer:!1},keepScriptTag:!1,callback:null,load:null,error:null},a=Date.now();function c(){}var l=function(e,r){if(!r)return window[e];window[e]=r},i=function(e,r){e.onload!==undefined?e.onload=function(){r()}:e.onreadystatechange=function(){"loaded"!=e.readyState&&"complete"!=e.readyState||(e.onreadystatechange=null,r())}},u=function(e,r){e.onerror=r};function f(n,f){"string"==typeof n&&(n={url:n}),f||(f={});var p,d,s=r({},o,n||{}),m=e({callback:s.callback,load:s.load,error:s.error},f),y=s.params,b="",v="",h=s.callbackProp;function g(){s.keepScriptTag||p.parentNode&&p.parentNode.removeChild(p),v&&l(v,c),i(p,c),u(p,c),d&&clearTimeout(d)}function k(){b="cancel",l(v)&&g()}h&&""!==y[h]&&(y[h]?v=y[h]:(v=s.callbackName||s.prefix+s.name+a++,y[h]=v));var j=s.timeout;j&&(d=setTimeout(function(){b="error",g(),m.error&&m.error(new Error("Request Timeout"))},j));var w=s.baseURL+s.url;w=(w+=t(y,~w.indexOf("?")?"&":"?")).replace("?&","?"),p=document.createElement("script");var R=s.scriptAttr;for(var T in delete R.text,delete R.src,R)p[T]=R[T];v&&l(v,function(e){b="callback",m.callback&&m.callback(e)}),i(p,function(){g(),"error"!==b&&(b="load",m.load&&m.load())}),u(p,function(){b="error",g(),m.error&&m.error(new Error("script error"))}),p.src=w;var x=document.getElementsByTagName("script")[0]||document.head||document.getElementsByTagName("head")[0];return x.parentNode.insertBefore(p,x),{cancel:k}}return f});
