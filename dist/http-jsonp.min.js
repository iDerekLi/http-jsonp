/*!
 * httpJsonp v1.1.0
 * 
 * Copyright (c) 2019-present Derek Li
 * Released under the MIT License - https://choosealicense.com/licenses/mit/
 * 
 * https://github.com/iDerekLi/http-jsonp
 */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).httpJsonp=r()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function r(e){function t(t,n){if("object"==typeof e[n]&&"object"==typeof t)e[n]=r(e[n],t);else if("object"==typeof t&&null!==t){var o="[object Array]"===Object.prototype.toString.call(t)?[]:{};e[n]=r(o,t)}else e[n]=t}for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];for(var c=0,l=o.length;c<l;c++)for(var i in o[c])t(o[c][i],i);return e}function t(e,r,n){if("object"!=typeof e||null===e)throw Error("obj is not an Object type");if(!r)return e;var o="string"==typeof r?r.split("."):r,a=o.length,c=o.shift();if("string"!=typeof c||""===c)throw Error("error attribute path");return a>1?t(e[c],o,n):n!==undefined?e[c]=n:e[c]}function n(e,r){for(var t in r)if(e===r[t])return!0;return!1}function o(e,r){void 0===r&&(r=""),r="boolean"==typeof r?"?":r;var t=[],o=function(r){var o=e[r];if(n(o,["",undefined,null]))return"continue";o.constructor===Array?o.forEach(function(e){t.push(encodeURIComponent(r)+"[]="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o))};for(var a in e)o(a);return t.length?r+t.join("&"):""}var a={baseURL:"",url:"",params:{},callbackProp:"callback",callbackNamespase:"__httpJsonpCallback",callbackName:"",timeout:6e4,scriptAttr:{type:"",charset:"",crossOrigin:null,async:!0,defer:!1},keepScriptTag:!1,callback:null,load:null,error:null},c=Date.now();function l(){}var i=function(e,r,n){var o=t(window,e);if(o=e&&!o?t(window,e,{}):o||window,!n)return o[r];o[r]=n},u=function(e,r){e.onload!==undefined?e.onload=function(){r()}:e.onreadystatechange=function(){"loaded"!=e.readyState&&"complete"!=e.readyState||(e.onreadystatechange=null,r())}},f=function(e,r){e.onerror=r};function p(t,n){"string"==typeof t&&(t={url:t}),n||(n={});var p,d,s=r({},a,t||{}),b=e({callback:s.callback,load:s.load,error:s.error},n),m=s.params,y="",h="",v=s.callbackNamespase,g=s.callbackProp;function k(){s.keepScriptTag||p.parentNode&&p.parentNode.removeChild(p),h&&i(v,h,l),u(p,l),f(p,l),d&&clearTimeout(d)}function j(){y="cancel",i(v,h)&&k()}g&&""!==m[g]&&(h=m[g]?m[g]:s.callbackName||"jp"+c++,m[g]=v?v+"."+h:h);var w=s.timeout;w&&(d=setTimeout(function(){y="error",k(),b.error&&b.error(new Error("Request Timeout"))},w));var N=s.baseURL+s.url;N=(N+=o(m,~N.indexOf("?")?"&":"?")).replace("?&","?"),p=document.createElement("script");var E=s.scriptAttr;for(var O in delete E.text,delete E.src,E)p[O]=E[O];h&&i(v,h,function(e){y="callback",k(),b.callback&&b.callback(e)}),u(p,function(){k(),"error"!==y&&(y="load",b.load&&b.load())}),f(p,function(){y="error",k(),b.error&&b.error(new Error("script error"))}),p.src=N;var R=document.getElementsByTagName("script")[0]||document.head||document.getElementsByTagName("head")[0];return R.parentNode.insertBefore(p,R),{cancel:j}}return p});
